(function(e,t){"use strict";var n=function(n){this.$selectedMap=n.find(".map-destination :selected");var r=this.$selectedMap.attr("data-latLng").split(",");this.latLng=new google.maps.LatLng(t(r[0],10),t(r[1],10));this.zoom=19;this.$mapForm=n;this.map=this.getMap();this.setMarker();this.setLine();this.setPolygon();this.setDirectionsOnMap();this.$mapForm.show();this.$mapForm.find(".map-setRoute").click(e.proxy(this.setRoute,this))};n.prototype={constructor:n,getMap:function(){return new google.maps.Map(e(".map-canvas")[0],{zoom:this.zoom,center:this.latLng,mapTypeId:google.maps.MapTypeId.SATELLITE})},getCoordinates:function(e){var t=google.maps.LatLng;var n=[];var e=e.split(",");for(var r=0;r<e.length;r++){n.push(new t(e[r],e[r+1]));r=r+1}return n},getPlan:function(){return e("<img>").attr("class","poly-info").attr("src",this.$selectedMap.attr("data-plan"))[0]},getRequest:function(){return{destination:this.latLng,origin:this.$mapForm.find(".map-departure").val(),travelMode:google.maps.TravelMode[this.$mapForm.find(".map-mode").val()]}},setPolygon:function(){this.polygon=new google.maps.Polygon({paths:this.getCoordinates(this.$selectedMap.attr("data-coords")),strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35});this.polygon.setMap(this.map);google.maps.event.addListener(this.polygon,"click",e.proxy(this.setPolygonInfo,this))},setDirectionsOnMap:function(){this.directionsService=new google.maps.DirectionsService;this.directionsRenderer=new google.maps.DirectionsRenderer;this.directionsRenderer.setMap(this.map)},setDirections:function(e,t){if(t===google.maps.DirectionsStatus.OK){this.directionsRenderer.setDirections(e)}},setLine:function(){var e={path:google.maps.SymbolPath.CIRCLE,strokeOpacity:1,scale:4};new google.maps.Polyline({path:this.getCoordinates(this.$selectedMap.attr("data-walking-path")),strokeOpacity:0,strokeColor:"#0066FF",icons:[{icon:e,offset:"0",repeat:"20px"}],map:this.map})},setMarker:function(){this.marker=new google.maps.Marker({position:this.latLng,map:this.map,animation:google.maps.Animation.DROP})},setPolygonInfo:function(){(new google.maps.InfoWindow({content:this.getPlan()})).open(this.map,this.marker)},setRoute:function(){this.map.setMapTypeId(google.maps.MapTypeId.ROADMAP);this.directionsService.route(this.getRequest(),e.proxy(this.setDirections,this))}};var r=function(e){var t=new n(e)};e(function(){var t=e(".map-form");r(t);t.find(".map-destination").change(function(){r(t)})})})(jQuery,window.parseFloat)